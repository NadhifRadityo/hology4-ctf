import math
from Crypto.Util.number import inverse, long_to_bytes

def lcm(a, b):
    return abs(a*b) // math.gcd(a, b)

# Credit: https://github.com/xnomas/PicoCTF-2021-Writeups/blob/main/Mind_Your_Ps_and_Qs/README.md
# The key is literally N being a small number
# Thus, the p and q can be searched fairly easily
# http://factordb.com/
c = 321844879443799286549616056453719822709840545282682732690577235851047094937366911007717317072752213559125601968032569897506675141937851362142148845290499884757701080848891662169881594908450975760019374029754791980562574585211359914050961374737676773306083363840460239519359061743425486628209965441941969429641466193384452737677782200989564272998068744552313400694605172012548944529838226233798574982599443192033944273773623016095797845198724712190102294161708563241682753686685747388336594574996448028059246651472253294512869996359349792364048835516278374034070033357732534274439997813475414246467341211497093719930268781
n = 843239815892245266244219581024796168177009732072536598948576849568723769301014303199658552636862314234567097834998888879621353727703420597128992939934779673037414745095616667932471247991967384721146826108541211756338327881437494623338244152800309961592569337453796802255183709330806367570293007386710185340915143345633189496952544762990853196518175614740299254097961389831326939043323333544827051071081353286553349795849621830003391975750458179301424578022322385215838310374359046406748497852770216967977849295509283810580647563934500019469012264154685166694930402093320984696294731428854921023670193971786310418299244771
e = 168710
p = 53077
q = 15887103941297459657558256514588167533526946362313932568694101956944133415622855534405835910787390286462443202046063057060899329798282129681952501835725072499150568892281339712728135501101557825821859300799615874226846428423563777593651565702664241791973346976162872849919620727072109719281289586576298308889257933674344621906900253650184697637737167035444717186313495296104281309104194538968424196376610458137297695722245451513902292438352924605788280762332505326522567409129360107141483087830326072837158266207760118518014348285217702949846680561348327273488147447921340405378878448835746576175559921845362594312023

# phi = lcm((p-1),(q-1))
phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c,d,n)
print(long_to_bytes(m))
